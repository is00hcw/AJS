<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <meta name="decorator" content="atl.general">
        <link type="text/css" rel="stylesheet" href="live-demo.css" media="all">
        <link type="text/css" rel="stylesheet" href="includeAJS.css" media="all">
        <script type="text/javascript" src="includeAJS.js"></script>
    </head>
    <body>
            <h1 id="page-heading"> AUI Sandbox </h1>
            <div id="toolbar">
                <div id='toolbar-logo' class='aui-logo'></div>
                <button id="dropdown" class="toolbar-button component-button"> Dropdown </button>
                <button id="dialog" class="toolbar-button component-button"> Dialog </button>
                <button id="inline-dialog" class="toolbar-button component-button"> Inline-Dialog </button>
                <button id="tables" class="toolbar-button component-button"> Tables </button>
                <button id="messages" class="toolbar-button component-button"> Messages </button>
                <button id="tabs" class="toolbar-button component-button"> Tabs </button>
                <button id="forms" class="toolbar-button component-button"> Forms </button>
                <div id="editor-tools">
                    <button id="refresh" class="toolbar-button"> Refresh </button>
                    <button id="clear" class="toolbar-button"> Clear </button>
                    <a href="http://confluence.atlassian.com/display/AUI/AUI+Components" id="documentation"> AUI Documentation </a>
                </div>
            </div>
            <div class="work-area">
                <div id="editors-parent">
                    <div id="html-parent" class="editor-parent">
                        <span class="heading-span"><h2 class="editor-heading" >HTML</h2></span>
                        <textarea id="html-editor" class="edit-box" ></textarea>
                    </div>
                    <div id="css-parent" class="editor-parent">
                        <span class="heading-span"><h2 class="editor-heading" >CSS</h2></span>
                        <textarea id="css-editor" class="edit-box" ></textarea>
                    </div>
                    
                    <div id="js-parent" class="editor-parent">
                        <span class="heading-span"><h2 class="editor-heading" >Javascript</h2></span>
                        <textarea id="js-editor" class="edit-box" ></textarea>
                    </div>
                </div>
                <h2 id="display-heading">&#9660; DISPLAY &#9660;</h2>
                <div id="display-parent" class="display-parent">
                    <div id="display" class="display">
                        <div id="html-code"></div>
                        <style type="text/css" id="css-code"></style>
                        <div id="js-code"></div>
                    </div>
                </div>
            </div>
        <script type="text/javascript">
        AJS.$(document).ready(function(){

                    refreshHTML = function(){
                        AJS.$("#display #html-code").html(AJS.$("#html-editor").val()); 
                    }
                    
                    refreshCSS = function(){
                        AJS.$("#display #css-code").html(AJS.$("#css-editor").val());  
                    }
                    
                    refreshJS = function(){
                        //refresh
                        var script = AJS.$("<script type='text/javascript'>");
                        script.append(AJS.$("#js-editor").val());
                        AJS.$("#display").append(script);
                    }
                    
                    refresh = function(){
                        //refresh html
                        refreshHTML();
                        //referesh css
                        refreshCSS();
                        //refresh js
                        refreshJS();
                    }
                    
                    //only run page javascript if the full-width-container he been added (prevents running code twice because of a re-trigger of dom-ready)
                    if(AJS.$(".full-width-container").size()==0){
                        var focused = null;
                        
                        AJS.$(".edit-box").mouseover(function(e){
                            var target = AJS.$(e.target).siblings(".headibg-spa");
                            if(focused!=e.target && !AJS.$(e.target).val()){
                                target.stop();
                                target.fadeTo(300, 0.4);  
                            }
                        });
                        
                        AJS.$(".edit-box").mouseout(function(e){
                            var target = AJS.$(e.target).siblings(".heading-span");
                            if(focused!=e.target && !AJS.$(e.target).val()){
                                target.stop();
                                target.fadeTo(300, 0.8);
                            }
                        });
                        AJS.$(".edit-box").focusin(function(e){
                            focused = this;
                            AJS.$(e.target).siblings(".heading-span").stop();
                            AJS.$(e.target).siblings(".heading-span").fadeOut(300);
                        });
                        
                        AJS.$(".edit-box").focusout(function(e){
                            focused = null;
                            if(!AJS.$(e.target).val()){
                                AJS.$(e.target).siblings(".heading-span").stop();
                                AJS.$(e.target).siblings(".heading-span").fadeTo(300, 0.8);
                            }
                        });
                        
                        AJS.$("body").children().wrapAll("<div class='full-width-container'/>");
                        AJS.drawLogo({containerID: "toolbar-logo", scaleFactor: 0.2});
                        AJS.$(".full-width-container").hide();
                        AJS.$(".full-width-container").fadeIn(500);
                        AJS.$("#html-editor").keypress(function(){
                            setTimeout("refreshHTML()", 100);
                        });
                        
                        AJS.$("#css-editor").keypress(function(){
                            setTimeout("refreshCSS()", 100);
                        });
                        
                        AJS.$("button#refresh").click(function(e){
                            e.preventDefault();
                            refresh();
                        });
                        
                        AJS.$("button#clear").click(function(){
                            AJS.$("#html-editor").val("");
                            AJS.$("#css-editor").val("");
                            AJS.$("#js-editor").val("");
                            refresh();
                        });
                        
                        var addComponentTemplate = function(component){
                            AJS.$.get("templates/" + component + "-template.html", function(data){
                                AJS.$("#html-editor").val(AJS.$("#html-editor").val() + "\n" + data);
                                refresh();
                            });
                            
                            AJS.$.get("templates/" + component + "-template.js", function(data){
                                AJS.$("#js-editor").val(AJS.$("#js-editor").val() + "\n" + data);
                                refresh();
                            });
                            
                        }
                        
                        AJS.$("#toolbar .component-button").click(function(e){
                            addComponentTemplate(AJS.$(e.target).attr("id"));
                        });
                        
                    }
                });
        </script>
        
        
    </body>

</html>
